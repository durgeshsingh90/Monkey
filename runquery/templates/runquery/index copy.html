{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Oracle Query UI</title>
  <link rel="stylesheet" href="{% static 'runquery/css/styles.css' %}">
  <link rel="icon" href="{% static 'runquery/images/database.png' %}" type="image/png">

  <!-- Add in your <head> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>

</head>
<body>
  <div class="layout-container">
    <div id="main-content">
      <div class="header">
        <div class="tabs">
          <button class="tab-button" data-index="0">Tab 1</button>
          <button class="tab-button" data-index="1">Tab 2</button>
          <button class="tab-button" data-index="2">Tab 3</button>
          <button onclick="location.href='/runquery/view_history/'">History</button>

        </div>
        <div class="top-controls">
          <select id="dropdown1"></select>
          <label class="toggle-switch" title="Vertical layout">
            <input type="checkbox" id="toggleVertical">
            <span class="slider"><span class="label-inside">↕</span></span>
          </label>
          <label class="toggle-switch" title="Toggle view mode">
            <input type="checkbox" id="toggleSwitch" onchange="toggleViewMode(this)">
            <span class="slider">
              <img id="toggleIcon" class="label-inside" src="{% static 'runquery/images/tablet.png' %}" alt="icon">
            </span>
          </label>
        </div>
      </div>

      <div id="tab-0" class="tab-content"><div id="editor-0" class="monaco-editor-container"></div></div>
      <div id="tab-1" class="tab-content"><div id="editor-1" class="monaco-editor-container"></div></div>
      <div id="tab-2" class="tab-content"><div id="editor-2" class="monaco-editor-container"></div></div>
      
      <div class="controls">
        <button onclick="execute()" title="Run query (Shift + Enter)">Execute</button>
        <button onclick="countQuery()">Count</button>
        <div id="customScriptDropdown" class="script-dropdown">
          <button onclick="toggleScriptDropdown()">📂 Load Saved Script ⌄</button>
          <div id="scriptList" class="script-list" style="display: none;"></div>
          <input type="text" id="scriptName" placeholder="Script name..." style="width: 200px;">
          <button id="saveBtn" onclick="saveCurrentScript()">💾 Save</button>
        </div>
        
        <div id="queryTimer"></div>
      </div>

      <div class="result-wrapper">
        <div id="result" class="result-section"></div>
        <div id="columnResult" class="result-section"></div>
        <div id="jsonResult" class="result-section" style="display: none;"></div>
      </div>
      
    <div id="sidebar">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <h3 style="margin: 0;">📘 Tables</h3>
        <div style="display: flex; gap: 6px;">
          <button onclick="collapseAllTables()" class="refresh-icon-btn" title="Collapse All">
            <img src="{% static 'runquery/images/collapse.png' %}" alt="Collapse" style="height: 18px;">
          </button>
          <button onclick="refreshMetadata()" class="refresh-icon-btn" title="Refresh Tables">
            <img src="{% static 'runquery/images/tablerefresh.png' %}" alt="Refresh">
          </button>
        </div>
      </div>
      <div class="search-container" style="position: relative; width: 100%;">
        <input 
          type="text" 
          id="tableSearch" 
          placeholder="🔍 Search tables..." 
          oninput="filterTables()" 
          style="width: 100%; padding-right: 24px;"
        >
        <button 
          onclick="clearSearch()" 
          title="Clear" 
          style="
            position: absolute;
            right: 6px;
            top: 50%;
            transform: translateY(-50%);
            border: none;
            background: transparent;
            font-size: 14px;
            cursor: pointer;
            color: #666;
            padding: 0;
            display: none;"
          id="clearBtn"
        >✖</button>
      </div>
      
      <label style="font-size: 13px; margin-top: 6px; display: block;">
        <input type="checkbox" id="pinnedOnlyToggle" onchange="filterTables()"> 📌 Show pinned only
      </label>
      
      <div id="tableStructure"></div>
    </div>
  </div>

  <script src="{% static 'runquery/js/scripts.js' %}"></script>
  
</body>
</html>
